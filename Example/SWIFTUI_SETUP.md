# SwiftUI ä¸»ç•Œé¢é…ç½®æŒ‡å—

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. **åˆ›å»ºäº† SwiftUI æ–‡ä»¶**

#### **SharedItem.swift** - æ•°æ®æ¨¡å‹
- `SharedItem` ç»“æ„ï¼šåˆ†äº«å†…å®¹é¡¹æ¨¡å‹
- `SharedContentType` æšä¸¾ï¼šæ”¯æŒ URLã€å›¾ç‰‡ã€æ–‡æœ¬ã€PDFã€æ–‡æ¡£ã€è§†é¢‘
- `SharedItemsManager` ç±»ï¼šç®¡ç†åˆ†äº«å†…å®¹ï¼ˆå¢åˆ æ”¹æŸ¥ã€æŒä¹…åŒ–ï¼‰

#### **SharedItemRow.swift** - åˆ—è¡¨è¡Œè§†å›¾
- æ˜¾ç¤ºæ¯ä¸ªåˆ†äº«é¡¹çš„å›¾æ ‡ã€æ ‡é¢˜ã€å†…å®¹é¢„è§ˆ
- å½©è‰²åœ†å½¢å›¾æ ‡
- ç±»å‹æ ‡ç­¾å’Œæ—¶é—´æˆ³

#### **MainView.swift** - ä¸»ç•Œé¢
- SwiftUI ä¸»è§†å›¾ï¼Œæ˜¾ç¤ºåˆ†äº«å†…å®¹åˆ—è¡¨
- æ”¯æŒæ»‘åŠ¨åˆ é™¤
- ç©ºçŠ¶æ€è§†å›¾ï¼ˆæ— å†…å®¹æ—¶ï¼‰
- è¯¦æƒ…è§†å›¾
- æ¸…ç©ºæ‰€æœ‰åŠŸèƒ½
- æ·»åŠ æµ‹è¯•å†…å®¹åŠŸèƒ½

### 2. **ä¿®æ”¹äº†ç°æœ‰æ–‡ä»¶**

#### **SceneDelegate.m**
- âœ… å¯¼å…¥ SwiftUI æ¡†æ¶
- âœ… ä½¿ç”¨ `UIHostingController` æ‰˜ç®¡ SwiftUI è§†å›¾
- âœ… è®¾ç½® `MainView` ä¸ºæ ¹è§†å›¾

#### **Info.plist**
- âœ… ç§»é™¤äº† `UILaunchStoryboardName`ï¼ˆå–æ¶ˆå¯åŠ¨ç”»é¢ï¼‰
- âœ… åº”ç”¨å¯åŠ¨åç›´æ¥æ˜¾ç¤ºä¸»ç•Œé¢

---

## ğŸš€ åœ¨ Xcode ä¸­é…ç½®

### æ­¥éª¤ 1ï¼šæ·»åŠ  Swift æ–‡ä»¶åˆ°é¡¹ç›®

1. **æ‰“å¼€ Xcode** ä¸­çš„ XExtensionItemExample.xcworkspace

2. **åœ¨ Project Navigator ä¸­å³é”®ç‚¹å‡» `App` æ–‡ä»¶å¤¹**

3. **é€‰æ‹© "Add Files to 'XExtensionItemExample'..."**

4. **å¯¼èˆªåˆ°** `/Users/raoqu/mylab/iosShare/Example/App`

5. **æŒ‰ä½ âŒ˜ é”®ï¼Œé€‰æ‹©ä»¥ä¸‹ 3 ä¸ªæ–°æ–‡ä»¶ï¼š**
   - âœ… `SharedItem.swift`
   - âœ… `SharedItemRow.swift`
   - âœ… `MainView.swift`

6. **é…ç½®é€‰é¡¹ï¼š**
   - âŒ å–æ¶ˆå‹¾é€‰ "Copy items if needed"
   - âœ… å‹¾é€‰ "App" æˆ– "XExtensionItemExample" target
   - ç‚¹å‡» **"Add"**

### æ­¥éª¤ 2ï¼šæ·»åŠ  SceneDelegateï¼ˆå¦‚æœè¿˜æ²¡æ·»åŠ ï¼‰

å¦‚æœä¹‹å‰è¿˜æ²¡æ·»åŠ  SceneDelegateï¼š

1. æŒ‰ä½ âŒ˜ é”®ï¼Œé€‰æ‹©ï¼š
   - âœ… `SceneDelegate.h`
   - âœ… `SceneDelegate.m`

2. åŒæ ·é…ç½®å¹¶æ·»åŠ åˆ°é¡¹ç›®

### æ­¥éª¤ 3ï¼šé…ç½® Bridging Headerï¼ˆå¦‚æœè¿˜æ²¡é…ç½®ï¼‰

1. **é€‰æ‹©é¡¹ç›®** â†’ **App Target** â†’ **Build Settings**

2. **æœç´¢** "bridging"

3. **è®¾ç½® "Objective-C Bridging Header"** ä¸ºï¼š
   ```
   App/XExtensionItemExample-Bridging-Header.h
   ```

### æ­¥éª¤ 4ï¼šClean å¹¶é‡æ–°æ„å»º

```
âŒ˜ + Shift + K  (Clean Build Folder)
âŒ˜ + B          (Build)
âŒ˜ + R          (Run)
```

---

## ğŸ“± é¢„æœŸæ•ˆæœ

### å¯åŠ¨è¡Œä¸º
- âŒ **ä¹‹å‰ï¼š** æ˜¾ç¤ºå¯åŠ¨ç”»é¢ï¼ˆLaunch Screenï¼‰
- âœ… **ç°åœ¨ï¼š** ç›´æ¥æ˜¾ç¤ºä¸»ç•Œé¢ï¼ˆæ— å¯åŠ¨ç”»é¢ï¼‰

### ä¸»ç•Œé¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† TransAny                    â‹¯  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚  å·²æ¥æ”¶çš„åˆ†äº«å†…å®¹                 â”‚
â”‚                                  â”‚
â”‚  â­• Apple iPad Air 2       >     â”‚
â”‚  ğŸ”— URL                          â”‚
â”‚     http://apple.com/...         â”‚
â”‚     2024-10-14 13:00            â”‚
â”‚                                  â”‚
â”‚  â­• æ¬¢è¿ä½¿ç”¨ TransAny      >     â”‚
â”‚  ğŸ“ æ–‡æœ¬                         â”‚
â”‚     è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬...          â”‚
â”‚     1 å°æ—¶å‰                     â”‚
â”‚                                  â”‚
â”‚  â­• äº§å“æ–‡æ¡£.pdf          >     â”‚
â”‚  ğŸ“„ PDF                          â”‚
â”‚     https://example.com/...     â”‚
â”‚     2 å°æ—¶å‰                     â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŠŸèƒ½ç‰¹æ€§

#### âœ… åˆ—è¡¨åŠŸèƒ½
- æ˜¾ç¤ºæ‰€æœ‰æ¥æ”¶åˆ°çš„åˆ†äº«å†…å®¹
- å‘å·¦æ»‘åŠ¨å¯ä»¥åˆ é™¤å•é¡¹
- ç‚¹å‡»é¡¹ç›®æŸ¥çœ‹è¯¦æƒ…

#### âœ… å·¥å…·æ èœå•ï¼ˆå³ä¸Šè§’ â‹¯ï¼‰
- **æ¸…ç©ºæ‰€æœ‰** - åˆ é™¤æ‰€æœ‰åˆ†äº«å†…å®¹
- **æ·»åŠ æµ‹è¯•** - æ·»åŠ æµ‹è¯•æ•°æ®ï¼ˆç”¨äºæ¼”ç¤ºï¼‰

#### âœ… ç©ºçŠ¶æ€
å½“æ²¡æœ‰å†…å®¹æ—¶æ˜¾ç¤ºï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                  â”‚
â”‚            ğŸ“¦                    â”‚
â”‚                                  â”‚
â”‚        æš‚æ— åˆ†äº«å†…å®¹              â”‚
â”‚                                  â”‚
â”‚   ä»å…¶ä»–åº”ç”¨åˆ†äº«å†…å®¹åˆ° TransAny  â”‚
â”‚      å†…å®¹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ            â”‚
â”‚                                  â”‚
â”‚     [ + æ·»åŠ æµ‹è¯•å†…å®¹ ]           â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### âœ… è¯¦æƒ…è§†å›¾
ç‚¹å‡»ä»»ä¸€é¡¹ç›®åï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         è¯¦æƒ…              å®Œæˆ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚  ğŸ”— URL         2024-10-14 13:00 â”‚
â”‚                                  â”‚
â”‚  æ ‡é¢˜                            â”‚
â”‚  Apple iPad Air 2                â”‚
â”‚                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
â”‚                                  â”‚
â”‚  å†…å®¹                            â”‚
â”‚  http://apple.com/ipad-air-2/    â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ SwiftUI ç‰¹æ€§

### ä½¿ç”¨çš„ SwiftUI ç»„ä»¶
- `NavigationView` - å¯¼èˆªå®¹å™¨
- `List` - åˆ—è¡¨è§†å›¾
- `ForEach` - åŠ¨æ€åˆ—è¡¨é¡¹
- `.swipeActions` - æ»‘åŠ¨æ“ä½œ
- `.sheet` - æ¨¡æ€è§†å›¾
- `.alert` - è­¦å‘Šå¯¹è¯æ¡†
- `.toolbar` - å·¥å…·æ 
- `Menu` - èœå•
- `@StateObject` - çŠ¶æ€ç®¡ç†
- `@State` - æœ¬åœ°çŠ¶æ€

### æ•°æ®æŒä¹…åŒ–
- ä½¿ç”¨ `UserDefaults` ä¿å­˜åˆ†äº«å†…å®¹
- `Codable` åè®®å®ç°åºåˆ—åŒ–
- åº”ç”¨é‡å¯åæ•°æ®ä¿ç•™

---

## ğŸ”— ä¸ Share Extension é›†æˆ

### å½“ç”¨æˆ·ä»å…¶ä»–åº”ç”¨åˆ†äº«å†…å®¹æ—¶ï¼š

1. **Share Extension æ¥æ”¶å†…å®¹**
   - åœ¨ `ShareViewController.m` ä¸­å¤„ç†

2. **ä¿å­˜åˆ° SharedItemsManager**
   ```objc
   // åœ¨ ShareViewController.m ä¸­æ·»åŠ 
   SharedItem *item = [[SharedItem alloc] init...];
   [[SharedItemsManager shared] addItem:item];
   ```

3. **ä¸»åº”ç”¨è‡ªåŠ¨æ›´æ–°**
   - `@Published` å±æ€§è‡ªåŠ¨è§¦å‘ UI æ›´æ–°
   - åˆ—è¡¨å®æ—¶æ˜¾ç¤ºæ–°å†…å®¹

---

## ğŸ¯ ä¸‹ä¸€æ­¥ï¼šé›†æˆ Share Extension

### ä¿®æ”¹ ShareViewController.m

éœ€è¦åœ¨æ¥æ”¶åˆ°åˆ†äº«å†…å®¹åï¼Œä¿å­˜åˆ° `SharedItemsManager`ï¼š

```objc
#import "XExtensionItemExample-Swift.h"

- (void)viewDidLoad {
    [super viewDidLoad];
    
    for (NSExtensionItem *extensionItem in self.extensionContext.inputItems) {
        XExtensionItem *xExtensionItem = [[XExtensionItem alloc] initWithExtensionItem:extensionItem];
        
        // åˆ›å»º SharedItem å¹¶ä¿å­˜
        NSString *title = xExtensionItem.title ?: @"æœªå‘½å";
        NSString *content = xExtensionItem.attributedContentText.string ?: @"";
        
        SharedItem *item = [[SharedItem alloc] initWithId:[[NSUUID UUID]]
                                                    title:title
                                              contentType:SharedContentTypeText
                                                  content:content
                                                timestamp:[NSDate date]
                                            thumbnailData:nil];
        
        [[SharedItemsManager shared] addItem:item];
    }
}
```

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šæ‰¾ä¸åˆ° MainView ç±»

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤ Swift æ–‡ä»¶å·²æ·»åŠ åˆ° Xcode é¡¹ç›®
2. æ£€æŸ¥ Target Membership æ˜¯å¦å‹¾é€‰
3. Clean Build Folder (âŒ˜ + Shift + K)

### é—®é¢˜ 2ï¼šBridging header é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ Build Settings ä¸­çš„è·¯å¾„
2. ç¡®ä¿ `XExtensionItemExample-Bridging-Header.h` å­˜åœ¨
3. é‡æ–°æ„å»º

### é—®é¢˜ 3ï¼šåº”ç”¨å¯åŠ¨æ—¶å´©æºƒ

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. ç¡®è®¤ SceneDelegate å·²æ·»åŠ åˆ°é¡¹ç›®
3. éªŒè¯ Info.plist ä¸­çš„ SceneDelegate é…ç½®

---

## âœ… éªŒè¯æ¸…å•

æ„å»ºå¹¶è¿è¡Œåï¼Œæ£€æŸ¥ï¼š

- [ ] åº”ç”¨å¯åŠ¨æ—¶**æ— å¯åŠ¨ç”»é¢**ï¼Œç›´æ¥æ˜¾ç¤ºä¸»ç•Œé¢
- [ ] ä¸»ç•Œé¢ä½¿ç”¨ **SwiftUI** å®ç°
- [ ] æ˜¾ç¤º**åˆ†äº«å†…å®¹åˆ—è¡¨**ï¼ˆé»˜è®¤æœ‰ 3 ä¸ªç¤ºä¾‹ï¼‰
- [ ] å¯ä»¥**æ»‘åŠ¨åˆ é™¤**åˆ—è¡¨é¡¹
- [ ] ç‚¹å‡»é¡¹ç›®å¯ä»¥æŸ¥çœ‹**è¯¦æƒ…**
- [ ] å³ä¸Šè§’èœå•æœ‰**æ¸…ç©ºæ‰€æœ‰**å’Œ**æ·»åŠ æµ‹è¯•**åŠŸèƒ½
- [ ] ç©ºçŠ¶æ€æ—¶æ˜¾ç¤º**æç¤ºä¿¡æ¯**
- [ ] åº”ç”¨åç§°æ˜¾ç¤ºä¸º **"TransAny"**

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„åº”ç”¨ï¼š
- âœ… ä½¿ç”¨ SwiftUI æ„å»ºä¸»ç•Œé¢
- âœ… æ— å¯åŠ¨ç”»é¢ï¼Œå¿«é€Ÿå¯åŠ¨
- âœ… æ˜¾ç¤ºæ¥æ”¶åˆ°çš„åˆ†äº«å†…å®¹åˆ—è¡¨
- âœ… æ”¯æŒæ•°æ®æŒä¹…åŒ–
- âœ… ç°ä»£åŒ–çš„ iOS è®¾è®¡

**ä¸‹ä¸€æ­¥å¯ä»¥é›†æˆ Share Extensionï¼Œå®ç°çœŸæ­£çš„å†…å®¹æ¥æ”¶ï¼** ğŸš€
